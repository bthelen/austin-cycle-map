<!DOCTYPE html>
<html>
    <head>
        <title>AustinCycleMap</title>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
        <link rel="icon" type="image/png" href="favicon.png" />
        <link rel="apple-touch-icon" href="touch-icon-iphone.png">
        <link rel="apple-touch-icon" sizes="76x76" href="touch-icon-ipad.png">
        <link rel="apple-touch-icon" sizes="120x120" href="touch-icon-iphone-retina.png">
        <link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad-retina.png">        
        <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css"/>
        <script src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js?2"></script>
        <style>
            html { height: 100% }
            body { height: 100%; margin: 0; padding: 0px 0px 0px 0px }
            .info { padding: 6px 8px; font: 12px/14px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; }
            .info h4 { margin: 0 0 5px; color: #777; }
            .legend { line-height: 16px; color: #555; }
            .legend i { width: 16px; height: 16px; float: left; margin-right: 8px; opacity: 0.7; }   
            .legend-title { text-align: left; margin-bottom: 5px; font-weight: bold; font-size: 90%; }         
        </style>
    </head>
    <body>
        <div id="map" style="width: 100%; height: 100%"></div>
        <script>
            var map = L.map('map', {
              maxBounds: L.latLngBounds(L.latLng(29.9276, -98.2246), L.latLng(30.6793,-97.229))
            }).setView([30.2703704,-97.736922], 14);
            var osmAustin = L.tileLayer('http://basemaptiles{s}.austincyclemap.com/austin-open-street-map/{z}/{x}/{y}.png', {
              minZoom: 10,
              maxZoom: 18,
              attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'
            }).addTo(map);
            var bikeRoutes = L.tileLayer('http://tiles{s}.austincyclemap.com/austin-bike-routes/{z}/{x}/{y}.png', {
              minZoom: 10,
              maxZoom: 18,
              attribution: 'Bike Routes Courtesy of <a href="http://www.austintexas.gov/department/gis-and-maps">City of Austin GIS Division</a>'
            }).addTo(map);
            var baseLayers = {
              "Streets": osmAustin
            };
            var overlays = {
              "City of Austin Bike Routes": bikeRoutes
            };
            L.control.layers(baseLayers, overlays).addTo(map);
            map.on('locationfound', onLocationFound);
            map.on('locationerror', onLocationError);
            map.locate({setView: true, maxZoom: 16});
            var legend = L.control({position: 'bottomright'});

            legend.onAdd = function (map) {
              var div = L.DomUtil.create('div', 'info legend');
              div.innerHTML += '<div class="legend-title">Bikeability Index of Bike Routes</div> ';              
              div.innerHTML += '<i style="background:#229A00;"></i>High Ease of Use<br>';
              div.innerHTML += '<i style="background:#4B5ACE;"></i>Medium Ease of Use<br>';
              div.innerHTML += '<i style="background:#FF6600;"></i>Low Ease of Use -- Not for Novice Cyclist<br>';
              return div;
            };
            legend.addTo(map);            
            function onLocationFound(e) {
              var radius = e.accuracy / 2;
              L.circle(e.latlng, radius).addTo(map);
            }
            function onLocationError(e) {
              alert(e.message);
            }
        </script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            
            ga('create', 'UA-47433344-1', 'austincyclemap.com');
            ga('send', 'pageview');
            
        </script>
    </body>
</html>